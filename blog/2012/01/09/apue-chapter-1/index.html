
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Advanced Programming in the UNIX Environment - Chapter 1 - ApprEngineer.log</title>
  <meta name="author" content="kentaktwo">

  
  <meta name="description" content="unix プログラミングを知っておく必要があるので、勉強することにしました。
翻訳版が古いので原書を読むことにしました。 Amazon: Advanced Programming in the UNIX Environment Chapter 1 は UNIX システムについての概要。 UNIX &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://kentaktwo.github.com/blog/2012/01/09/apue-chapter-1">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="ApprEngineer.log" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">ApprEngineer.log</a></h1>
  
    <h2>A blogging framework for hackers.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:kentaktwo.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Advanced Programming in the UNIX Environment - Chapter 1</h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-01-09T21:02:00+09:00" pubdate data-updated="true">Jan 9<span>th</span>, 2012</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>unix プログラミングを知っておく必要があるので、勉強することにしました。<br/>
翻訳版が古いので原書を読むことにしました。</p>

<p><a href="http://www.amazon.com/Advanced-Programming-UNIX-Environment-2nd/dp/0201433079">Amazon: Advanced Programming in the UNIX Environment</a></p>

<p>Chapter 1 は UNIX システムについての概要。</p>

<!--more-->


<hr />

<h2>UNIX アーキテクチャ</h2>

<p>Operating System (OS) とは、コンピュータのハードウェアを抽象化したインターフェースをアプリケーションに提供するソフトウェアのこと。
その中でコンピュータのハードウェアリソースを管理し、その下でプログラムが動く環境を提供する中核部分のことを kernel と呼ぶ。
それ以外の部分はユーザランドと呼ぶ。</p>

<p>kernel とのインターフェースとなるソフトウェアのことを system call と呼ぶ。
関数ライブラリ群は system call の上に作られるが、アプリケーションは両方呼ぶことができる。</p>

<p>こんな感じ？</p>

<pre><code>
applications
｜　　｜
｜　　library routines
｜　　｜
system calls
｜
kernel
</code></pre>


<p>shell は他のアプリケーションを動かすための特別なアプリケーションのこと。</p>

<h2>ログイン</h2>

<p>ユーザが UNIX システムにログインするために、 login name と password を入れると、 システムはパスワードファイル（通常は /etc/passwd）を見に行く。
パスワードファイルには、</p>

<ul>
<li>login name</li>
<li>暗号化されたパスワード</li>
<li>user ID（数値）</li>
<li>group ID（数値）</li>
<li>コメント</li>
<li>home directory</li>
<li>使う shell のパス</li>
</ul>


<p>がコロン (:) で区切られて書かれている。</p>

<p>sar:x:205:105:Stephen Rago:/home/sar:/bin/ksh
パスワードは最近のシステムではここではなく、別のファイルに書かれている (Chapter 6) 。</p>

<h2>ファイル・ディレクトリ</h2>

<p>UNIX ファイルシステムは directory と file からなる階層構造になっている。
directory とは、directory entry を含んだ file のこと。
directory entry には、file の属性や filename が格納されている。
file の属性とは file の種類 (file, directory) 、ファイルサイズ、ファイル所有者、アクセス権などのこと。
stat や fstat 関数を用いて属性を取得することができる。詳しくは Chapter 4 で。</p>

<p>filename に使える文字はスラッシュ (/) と null 文字以外。スラッシュは pathname に使われ、 null 文字は終端記号に使われる。
新しく directory が作られると、. と .. の2つの filename が自動的に作られる。 root directory では、.. は . と同じ。</p>

<p>opendir() 関数は、 DIR 構造体のポインタを返す。readdir() 関数は DIR 構造体のポインタを引数に取り、 dirent 構造体のポインタを返す。もう読むエントリが無い場合は null ポインタを返す。
dirent 構造体には directory entry に関する情報が入っており、d_name で directory entry の名前が取れる。</p>

<p>プログラムを終了するとき、exit() 関数を呼ぶが、慣例により、正常終了のときは 0 、エラーのときは 1 から 255 のいずれかを引数に渡す。</p>

<h2>インプット・アウトプット</h2>

<p>File descriptor とは、 kernel が file にアクセスするために用いる識別子で、普通は非負の小さい整数を用いる。
慣例により、標準入力には 0 (STDIN_FILENO)、標準出力には 1 (STDOUT_FILENO)、標準エラー出力には 2 (STDERR_FILENO) が既に割り当てられている。 これらのマクロは unistd.h に定義されている。詳しくは Chapter 3 で。</p>

<h2>プログラム・プロセス</h2>

<p>program とは、実行可能な file のこと。プログラムはメモリに読み込まれ、kernel によって実行される。詳しくは Chapter 8 で。</p>

<p>実行中のプログラムのインスタンスのことを process という。OS によっては task ということもある。
UNIX システムでは、すべてのプロセスにはユニークな番号 (process ID) が振られる。プロセス ID は非負整数。</p>

<h2>エラー</h2>

<p>UNIX システム関数では、エラーが起こると大抵は負の値を返し、errno という整数型の変数に追加の情報が格納される。
errno にセットされる値は errno.h に定義されている。
errno の値が勝手にクリアされることは無いので、errno の値を調べるときは、エラーが起きた直後でなければならない。
また、errno の値が 0 にセットされることは無く、errno.h には 0 に設定されている定数も存在しない。</p>

<h2>ユーザ管理</h2>

<p>user ID は各ユーザに固有の値であり、 login name が作られるときにシステム管理者によって割り当てられる。
user ID が 0 のユーザは root あるいは superuser とよばれる。</p>

<p>group ID はユーザをグループ化して、リソースを共有したりするのに用いられ、login name が作られるときに割り当てられる。
group name と group ID の紐付けは group file という file に書かれている。group file は大抵の場合 /etc/group である。</p>

<p>user ID と group ID は getuid() 関数と getgid() 関数で取得できる。</p>

<h2>シグナル</h2>

<p>Signal はプロセスにある状態になったことを通知するのに用いられる。例えば 0 除算が発生した場合、プロセスに SIGFPE シグナルが送られる。
シグナルが送られた場合、プロセスは</p>

<ul>
<li>シグナルを無視する</li>
<li>シグナルに割り当てられたデフォルトの動作を行う</li>
<li>関数を割り当てる</li>
</ul>


<p>のいずれかを行うことになる。</p>

<p>シグナルは kill() 関数を使って発生させることもできる。詳しくは Chapter 10 で。</p>

<h2>時間管理</h2>

<p>UNIX システムは二種類の時間を管理している:</p>

<p>Calendar time: 1970 年 1 月 1 日 00:00:00 からの経過時間
Process time: プロセスによって消費されるプロセッサのリソースを測る時間。CPU time とも呼ばれる
プログラムの実行時間を測ると、以下の3つの値が取得できる:</p>

<p>Clock time: プロセスが実行するのにかかった時間。この時間はシステム上で走っている他のプロセスの数に依存する。
User CPU time: プログラム中のループ等、ユーザの命令を行うのにかかった時間。
System CPU time: システムコールを行うのにかかった時間
user CPU time と system CPU time の合計が大体 CPU time と同じ。</p>

<h2>システムコール</h2>

<p>UNIX Programmer&#8217;s Manual の Section 2 には、システムコールのドキュメントが書かれている。
Section 3 には printf() の標準関数のドキュメントが書かれている。
標準関数は内部でシステムコールを呼んだりしているものもある。例えば、malloc(3) はsbrk(2) を呼んでいる</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">kentaktwo</span></span>

      








  


<time datetime="2012-01-09T21:02:00+09:00" pubdate data-updated="true">Jan 9<span>th</span>, 2012</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/unix/'>unix</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://kentaktwo.github.com/blog/2012/01/09/apue-chapter-1/" data-via="" data-counturl="http://kentaktwo.github.com/blog/2012/01/09/apue-chapter-1/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2012/01/09/octopress/" title="Previous Post: Octopress を使ってみる">&laquo; Octopress を使ってみる</a>
      
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/01/09/apue-chapter-1/">Advanced Programming in the UNIX Environment - Chapter 1</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/01/09/octopress/">Octopress を使ってみる</a>
      </li>
    
  </ul>
</section>






  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - kentaktwo -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'apprengineerlog';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://kentaktwo.github.com/blog/2012/01/09/apue-chapter-1/';
        var disqus_url = 'http://kentaktwo.github.com/blog/2012/01/09/apue-chapter-1/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
